# 2.3. Модель в нотации IDEF0

## Контекстная диаграмма A-0

```mermaid
flowchart LR
    subgraph inputs [" "]
        I1["Данные о книге"]
        I2["Запрос на обмен"]
        I3["Поисковый запрос"]
        I4["Данные пользователя"]
    end

    subgraph outputs [" "]
        O1["Результаты поиска"]
        O2["Подтверждение обмена"]
        O3["Уведомления"]
        O4["Рейтинг пользователя"]
    end

    subgraph controls [" "]
        C1["Правила платформы"]
        C2["Политика модерации"]
    end

    subgraph mechanisms [" "]
        M1["Веб-приложение"]
        M2["База данных"]
        M3["Пользователи"]
    end

    I1 --> A0
    I2 --> A0
    I3 --> A0
    I4 --> A0
    
    A0["A0: Управление обменом книг<br/>BookSwap"] --> O1
    A0 --> O2
    A0 --> O3
    A0 --> O4
    
    C1 -.-> A0
    C2 -.-> A0
    
    M1 -.-> A0
    M2 -.-> A0
    M3 -.-> A0
```

## Декомпозиция первого уровня A0

```mermaid
flowchart LR
    subgraph inputs [" "]
        I1["Данные о книге"]
        I2["Запрос на обмен"]
        I3["Поисковый запрос"]
        I4["Данные пользователя"]
    end

    subgraph outputs [" "]
        O1["Результаты поиска"]
        O2["Подтверждение обмена"]
        O3["Уведомления"]
        O4["Рейтинг пользователя"]
    end

    I4 --> A1["A1: Управление<br/>пользователями"]
    I1 --> A2["A2: Управление<br/>каталогом книг"]
    I3 --> A3["A3: Поиск<br/>книг"]
    I2 --> A4["A4: Обработка<br/>обмена"]
    
    A1 -->|"Профиль"| A2
    A1 -->|"Авторизация"| A3
    A1 -->|"Авторизация"| A4
    
    A2 -->|"Каталог"| A3
    A2 -->|"Данные книг"| A4
    
    A3 --> O1
    
    A4 --> O2
    A4 --> O3
    A4 -->|"Оценка"| A5["A5: Управление<br/>рейтингом"]
    
    A5 --> O4
    A5 -->|"Рейтинг"| A3
```

## Комментарии к модели IDEF0

### Контекстная диаграмма A-0

Диаграмма верхнего уровня представляет систему BookSwap как единый функциональный блок «Управление обменом книг».

**Входы (слева):**
- *Данные о книге* — информация, вводимая пользователем при добавлении книги в каталог (название, автор, ISBN, состояние, фото)
- *Запрос на обмен* — заявка от пользователя на получение книги у другого участника
- *Поисковый запрос* — критерии поиска (текст, фильтры, геолокация)
- *Данные пользователя* — регистрационные данные, настройки профиля

**Выходы (справа):**
- *Результаты поиска* — список книг, соответствующих критериям
- *Подтверждение обмена* — фиксация успешно завершённой сделки
- *Уведомления* — информирование пользователей о событиях (новый запрос, сообщение, книга из wishlist)
- *Рейтинг пользователя* — агрегированная оценка надёжности участника

**Управление (сверху):**
- *Правила платформы* — пользовательское соглашение, условия использования
- *Политика модерации* — правила обработки жалоб и блокировки контента

**Механизмы (снизу):**
- *Веб-приложение* — программный интерфейс системы
- *База данных* — хранилище информации (PostgreSQL)
- *Пользователи* — участники платформы, выполняющие действия

### Декомпозиция A0

Система разбита на пять функциональных блоков:

**A1: Управление пользователями**
Регистрация, авторизация, редактирование профиля, верификация. Выход — профиль пользователя, который используется остальными подсистемами для идентификации и проверки прав.

**A2: Управление каталогом книг**
Добавление, редактирование, удаление книг. Управление статусом доступности. Ведение wishlist. Формирует каталог, который используется для поиска и обмена.

**A3: Поиск книг**
Полнотекстовый поиск, фильтрация, геолокационный поиск. Использует каталог из A2 и рейтинги из A5 для ранжирования результатов.

**A4: Обработка обмена**
Ключевой процесс: приём запроса → согласование → подтверждение → фиксация. Включает внутренний чат между участниками. Генерирует уведомления и инициирует выставление оценок.

**A5: Управление рейтингом**
Сбор оценок и отзывов после завершения обмена. Расчёт среднего рейтинга. Предоставление данных для ранжирования в поиске и отображения в профиле.